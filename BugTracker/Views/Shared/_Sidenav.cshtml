@using Microsoft.AspNetCore.Identity
@using BugTracker.Models.Enums
@inject SignInManager<BTUser> SignInManager
@inject UserManager<BTUser> UserManager

@{
    string userId = UserManager.GetUserId(User);
}

<!-- Sidenav -->
<nav class="sidenav navbar navbar-vertical fixed-left navbar-expand-xs navbar-light bg-white" id="sidenav-main">
    <div class="scrollbar-inner">

        <!-- Brand -->
        <div class="sidenav-header  align-items-center">
            <a class="navbar-brand" href="javascript:void(0)">
                <img src="/img/btl-logo-974x288-bg-white.png" class="navbar-brand-img" alt="...">
            </a>
        </div>
        <div class="navbar-inner">
            <!-- Collapse -->
            <div class="collapse navbar-collapse" id="sidenav-collapse-main">

                <!-- Collapse header -->
                <div class="navbar-collapse-header d-md-none">
                    <div class="row">
                        <div class="col-6 collapse-brand">
                            <a href="/">
                                <img src="~/img/brand/blue.png">
                            </a>
                        </div>
                        <div class="col-6 collapse-close">
                            <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#sidenav-collapse-main" aria-controls="sidenav-main" aria-expanded="false" aria-label="Toggle sidenav">
                                <span></span>
                                <span></span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Navigation -->
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link @(Context.Request.Path == "/" ? "active" : "")" href="@Url.Action("Index", "Home")">
                            <i class="ni ni-tv-2 text-primary"></i> Dashboard
                        </a>
                    </li>
                    @if (User.IsInRole(nameof(Roles.Admin)))
                    {
                        <li class="nav-item">
                            <a class="nav-link @(Context.Request.Path == "/projects" ? "active" : "")" href="@Url.Action("AllProjects", "Projects")">
                                <i class="ni ni-folder-17 text-primary"></i> All Projects
                            </a>
                        </li>
                    }
                    else
                    {
                        <li class="nav-item">
                            <a class="nav-link @(Context.Request.Path == "/projects" ? "active" : "")" href="@Url.Action("MyProjects", "Projects")">
                                <i class="ni ni-folder-17 text-primary"></i> My Projects
                            </a>
                        </li>
                    }
                    @if (User.IsInRole(nameof(Roles.Admin)))
                    {
                        <li class="nav-item">
                            <a class="nav-link @(Context.Request.Path == "/tickets" ? "active" : "")" href="@Url.Action("AllTickets", "Tickets")">
                                <i class="ni ni-tag text-primary"></i> All Tickets
                            </a>
                        </li>
                    }
                    else
                    {
                        <li class="nav-item">
                            <a class="nav-link @(Context.Request.Path == "/tickets" ? "active" : "")" href="@Url.Action("MyTickets", "Tickets")">
                                <i class="ni ni-tag text-primary"></i> My Tickets
                            </a>
                        </li>
                    }
                    
                    
                    <li class="nav-item">
                        <a asp-controller="Profile" asp-action="UserDetails" asp-route-id="@userId" class="nav-link">
                            <i class="ni ni-single-02 text-primary"></i> Profile
                        </a>
                    </li>
                    
                    
                    @* Not required for now *@
                    
                    @* <li class="nav-item"> *@
                    @*     <a class="nav-link" href="#"> *@
                    @*         <i class="ni ni-key-25 text-info"></i> Login *@
                    @*     </a> *@
                    @* </li> *@
                    @* <li class="nav-item"> *@
                    @*     <a class="nav-link" href="#"> *@
                    @*         <i class="ni ni-circle-08 text-pink"></i> Register *@
                    @*     </a> *@
                    @* </li> *@

                </ul>
                
                <hr class="my-3">

                <ul class="navbar-nav">
                    <li class="nav-item">
                        <form class="nav-link" asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Action("Default", "Home", new {area = ""})">
                            <button type="submit" style="all: unset; cursor: pointer;">
                                <i class="ni ni-button-power text-primary"></i> &nbsp;&nbsp;Logout
                            </button>
                        </form>
                    </li>
                </ul>
                @*<!-- Divider -->
                <hr class="my-3">

                <!-- Heading -->
                <h6 class="navbar-heading p-0 text-muted">
                    <span class="docs-normal">Documentation</span>
                </h6>*@

                <!-- Navigation -->
            </div>
        </div>
    </div>

</nav>
